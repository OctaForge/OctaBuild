CXX = (getenv CXX c++)

OB_CXXFLAGS = "-g -Wall -Wextra -Wshadow -O2"

CS_PATH = "../libcubescript"
OS_PATH = "../octastd"

FILES = [main_ob.o globs_ob.o cubescript_ob.o]

OB_CXXFLAGS = [@OB_CXXFLAGS -std=c++14 -I. -I@CS_PATH -I@OS_PATH -pthread]

rule obuild $FILES [
    echo "  LD" $target
    shell $CXX $OB_CXXFLAGS -o obuild_ob $sources
]

rule %_ob.o %.cc [
    echo " CXX" $target
    shell $CXX $OB_CXXFLAGS -c -o $target $source
]

duprule cubescript_ob.o %_ob.o [@CS_PATH/cubescript.cc]

action clean [
    echo " CLEAN" $FILES obuild_ob
    shell rm -f $FILES obuild_ob
]

depend main_ob.o [@CS_PATH/cubescript.hh]
depend globs_ob.o [@CS_PATH/cubescript.hh]
depend cubescript_ob.o [@CS_PATH/cubescript.hh]

rule default obuild
